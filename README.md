# PyPS: An AWS SSM Parameter Store updater made in Python

## Overview

Takes an JSON file and stores its contens in [AWS SSM Parameter Store](https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-paramstore.html).

The parameters are stored using the following structure:
  ```/{environment}/{project-name}/{index}```
  * environment: `'development'|'staging'|'production'`
  * project-name: a way to identify the project
  * profile-name: aws profile (found on ~/.aws/credentials)
  * index: auto generated by PyPS

For example:
  `/development/email-sender/part_00000`

AWS SSM limits the size of each key to 4096 bytes. To bypass this limit, if the size of the input JSON is larger, PyPS splits it in 4096 bytes chunks and stores each one of them in a part.


## Usage
`pyps -e <environment> -p <project_name> -pn <aws_profile>`

The input file has to be in the running folder in a subdirectory `.pyps/` and must be named as the environment.
E.g.:
```
  .pyps/
    development.json
```

After the file is successfully parsed, PyPS checks for project existence. If the project is present and the user wants to update its configuration with the input JSON file, PyPS will create a backup at `~/.pyps/backups/` prior to overwriting it.



## Dependencies

* Python 3.6
* [Boto3](https://boto3.amazonaws.com/v1/documentation/api/latest/index.html)



## Prerequisites

[AWS credentials](https://docs.aws.amazon.com/cli/latest/userguide/cli-config-files.html) have to be configured in your environment and the executing role/user has to have access to SSM following actions:
  * get_parameters_by_path
  * put_parameter
  * delete_parameters


## Install as a command line tool

Just copy the file to a location that is present in your `PATH` and make it executable

```cp pyps.py /usr/local/bin/pyps```
```chmod +x /usr/local/bin/pyps```



